#!/bin/bash

# Title: run_encoders.sh

# Inputs: main_dir_name SEQ cfg_flag num_frames

## Description:
## Runs all encoders generated by "gen_dirs_and_codecs.sh" using the defined directory structure. 
## The cfg_flag defines the configuration file that is being used .

CFG="/home/rmonteiro/PhD/hm-15.0-ss-st-IEEE-JSTSP-LF-SPECIAL-ISSUE/cfg/3DHencoder_intra_main.cfg"
CFG_HEVC_ORIG="/home/rmonteiro/PhD/hm-16.5/cfg/encoder_intra_main.cfg"
CFG_HEVC_INTER_P="/home/rmonteiro/PhD/hm-16.5/cfg/encoder_lowdelay_P_main.cfg"
CFG_HEVC_INTER_B="/home/rmonteiro/PhD/hm-16.9/cfg/encoder_lowdelay_main.cfg"
CFG_HEVC_ALL_INTRA="/home/rmonteiro/PhD/hm-16.5/cfg/encoder_lowdelay_P_main_ALL_INTRA.cfg"

CFG_HEVC_REXT_INTER_B="/home/rmonteiro/PhD/hm-16.9/cfg/encoder_lowdelay_main_rext.cfg"

CFG_SPIRAL="/home/rmonteiro/PhD/hm-16.9-LF-PVS/cfg/spiral_nonscalable_encoder_lowdelay_main_rext.cfg"
CFG_SPIRAL_SCL="/home/rmonteiro/PhD/hm-16.9-LF-PVS/cfg/spiral_scalable_encoder_lowdelay_main_rext.cfg"
CFG_SPIRAL_YUV420_8="/home/rmonteiro/PhD/hm-16.9-LF-PVS/cfg/spiral_nonscalable_encoder_lowdelay_main.cfg"
CFG_SPIRAL_SCL_YUV420_8="/home/rmonteiro/PhD/hm-16.9-LF-PVS/cfg/spiral_scalable_encoder_lowdelay_main.cfg"

CFG_SPIRAL_SCL_RA_1="/home/rmonteiro/PhD/hm-16.9-LF-PVS/cfg/spiral_scalable_RA_2way_encoder_lowdelay_main_rext.cfg"
CFG_SPIRAL_SCL_RA_2="/home/rmonteiro/PhD/hm-16.9-LF-PVS/cfg/spiral_scalable_RA_4way_encoder_lowdelay_main_rext.cfg"
CFG_SPIRAL_SCL_RA_3="/home/rmonteiro/PhD/hm-16.9-LF-PVS/cfg/spiral_scalable_RA_9way_encoder_lowdelay_main_rext.cfg"

# PVSSPIRAL YUV44410
FO=0
W=625
H=434
MIR=13
if [ $2 == "4DLF_13x13_PVS_I01_YUV444_10" ] ; then
        SEQ="/home/rmonteiro/PhD/Sequences/JPEG_Pleno/PVSSPIRAL/YUV44410/I01/I01_PVSSPIRAL_YUV44410.yuv"
fi
if [ $2 == "4DLF_13x13_PVS_I02_YUV444_10" ] ; then
        SEQ="/home/rmonteiro/PhD/Sequences/JPEG_Pleno/PVSSPIRAL/YUV44410/I02/I02_PVSSPIRAL_YUV44410.yuv"
fi
if [ $2 == "4DLF_13x13_PVS_I03_YUV444_10" ] ; then
        SEQ="/home/rmonteiro/PhD/Sequences/JPEG_Pleno/PVSSPIRAL/YUV44410/I03/I03_PVSSPIRAL_YUV44410.yuv"
fi
if [ $2 == "4DLF_13x13_PVS_I04_YUV444_10" ] ; then
        SEQ="/home/rmonteiro/PhD/Sequences/JPEG_Pleno/PVSSPIRAL/YUV44410/I04/I04_PVSSPIRAL_YUV44410.yuv"
fi
if [ $2 == "4DLF_13x13_PVS_I05_YUV444_10" ] ; then
        SEQ="/home/rmonteiro/PhD/Sequences/JPEG_Pleno/PVSSPIRAL/YUV44410/I05/I05_PVSSPIRAL_YUV44410.yuv"
fi
if [ $2 == "4DLF_13x13_PVS_I06_YUV444_10" ] ; then
        SEQ="/home/rmonteiro/PhD/Sequences/JPEG_Pleno/PVSSPIRAL/YUV44410/I06/I06_PVSSPIRAL_YUV44410.yuv"
fi
if [ $2 == "4DLF_13x13_PVS_I07_YUV444_10" ] ; then
        SEQ="/home/rmonteiro/PhD/Sequences/JPEG_Pleno/PVSSPIRAL/YUV44410/I07/I07_PVSSPIRAL_YUV44410.yuv"
fi
if [ $2 == "4DLF_13x13_PVS_I08_YUV444_10" ] ; then
        SEQ="/home/rmonteiro/PhD/Sequences/JPEG_Pleno/PVSSPIRAL/YUV44410/I08/I08_PVSSPIRAL_YUV44410.yuv"
fi
if [ $2 == "4DLF_13x13_PVS_I09_YUV444_10" ] ; then
        SEQ="/home/rmonteiro/PhD/Sequences/JPEG_Pleno/PVSSPIRAL/YUV44410/I09/I09_PVSSPIRAL_YUV44410.yuv"
fi
if [ $2 == "4DLF_13x13_PVS_I10_YUV444_10" ] ; then
        SEQ="/home/rmonteiro/PhD/Sequences/JPEG_Pleno/PVSSPIRAL/YUV44410/I10/I10_PVSSPIRAL_YUV44410.yuv"
fi
if [ $2 == "4DLF_13x13_PVS_I11_YUV444_10" ] ; then
        SEQ="/home/rmonteiro/PhD/Sequences/JPEG_Pleno/PVSSPIRAL/YUV44410/I11/I11_PVSSPIRAL_YUV44410.yuv"
fi
if [ $2 == "4DLF_13x13_PVS_I12_YUV444_10" ] ; then
        SEQ="/home/rmonteiro/PhD/Sequences/JPEG_Pleno/PVSSPIRAL/YUV44410/I12/I12_PVSSPIRAL_YUV44410.yuv"
fi

for qp in 12 17 22 27 32 37 42 47 52
do
	if [ -d $1/$2/$qp ]; then
	cd $1/$2/$qp 
	if [ $3 == 0 ] # HEVC-SS based (!search window 128!)
	then
       		./TAppEncoderStatic -c $CFG -i $SEQ -f 1 -mi 1 -mir $MIR -fr 25 -fs $FO -wdt $W -hgt $H -q $qp -sr 128 --ConformanceMode 1 --ConformanceWindowMode 1 &> out_${2}_${qp}.txt &
	fi
	if [ $3 == 1 ] # HEVC Intra (!series!)
	then
		./TAppEncoderStatic -c $CFG_HEVC_ORIG -i $SEQ -f 1 -fr 25 -fs $FO -wdt $W -hgt $H -q $qp -sr 128 --ConformanceMode 1 --ConformanceWindowMode 1 &> out_${2}_${qp}.txt
	fi
        if [ $3 == 11 ] # HEVC Intra YUV444_10 (!series!)
        then
                ./TAppEncoderStatic -c $CFG_HEVC_REXT_INTER_B -i $SEQ -fr 25 -fs $FO -f 1 -wdt $W -hgt $H -q $qp -sr 64 --InputChromaFormat=444 --ChromaFormatIDC=444 --InputBitDepth=10 --OutputBitDepth=10 --ConformanceMode 1 --ConformanceWindowMode 1 &> out_${2}_${qp}.txt
        fi
	if [ $3 == 2 ] # HEVC Inter B YUV420_8 (!search window 64!)
        then
                ./TAppEncoderStatic -c $CFG_HEVC_INTER_B -i $SEQ -fr 25 -fs $FO -f $4 -wdt $W -hgt $H -q $qp -sr 64 --ConformanceMode 1 --ConformanceWindowMode 1 &> out_${2}_${qp}.txt &
        fi
	if [ $3 == 22 ] # HEVC Inter B YUV444_10 (!search window 64!)
        then
                ./TAppEncoderStatic -c $CFG_HEVC_REXT_INTER_B -i $SEQ -fr 25 -fs $FO -f $4 -wdt $W -hgt $H -q $qp -sr 64 --InputChromaFormat=444 --ChromaFormatIDC=444 --InputBitDepth=10 --OutputBitDepth=10 --ConformanceMode 1 --ConformanceWindowMode 1 &> out_${2}_${qp}.txt &
        fi
        if [ $3 == 3 ] # HEVC Inter B YUV420_8 (!search window 64!) NON SCALABLE SPIRAL (!SAO OFF!)
        then
                ./TAppEncoderStatic -c $CFG_SPIRAL_YUV420_8 -i $SEQ -fr 25 -fs $FO -f $4 -wdt $W -hgt $H -q $qp -sr 64 --SAO=0 --ConformanceMode 1 --ConformanceWindowMode 1 &> out_${2}_${qp}.txt &
        fi
	if [ $3 == 33 ] # HEVC Inter B YUV444_10 (!search window 64!) NON SCALABLE SPIRAL (!SAO OFF!)
        then
                ./TAppEncoderStatic -c $CFG_SPIRAL -i $SEQ -fr 25 -fs $FO -f $4 -wdt $W -hgt $H -q $qp -sr 64 --SAO=0 --InputChromaFormat=444 --ChromaFormatIDC=444 --InputBitDepth=10 --OutputBitDepth=10 --ConformanceMode 1 --ConformanceWindowMode 1 &> out_${2}_${qp}.txt &
        fi
        if [ $3 == 4 ] # HEVC Inter B YUV420_8 (!search window 64!) SCALABLE SPIRAL (!SAO OFF!)
        then
                ./TAppEncoderStatic -c $CFG_SPIRAL_SCL_YUV420_8 -i $SEQ -fr 25 -fs $FO -f $4 -wdt $W -hgt $H -q $qp -sr 64 --SAO=0 --ConformanceMode 1 --ConformanceWindowMode 1 &> out_${2}_${qp}.txt &
        fi
	if [ $3 == 44 ] # HEVC Inter B YUV444_10 (!search window 64!) SCALABLE SPIRAL (!SAO OFF!) (!!!!!!SERIES!!!!!!!)
        then
                ./TAppEncoderStatic -c $CFG_SPIRAL_SCL -i $SEQ -fr 25 -fs $FO -f $4 -wdt $W -hgt $H -q $qp -sr 64 --SAO=0 --InputChromaFormat=444 --ChromaFormatIDC=444 --InputBitDepth=10 --OutputBitDepth=10 --ConformanceMode 1 --ConformanceWindowMode 1 &> out_${2}_${qp}.txt 
        fi
	if [ $3 == 441 ] # HEVC Inter B YUV444_10 (!search window 64!) SCALABLE SPIRAL (!SAO OFF!) RANDOM ACCESS PROFILE 2-WAY (!!!!!!SERIES!!!!!!!)
        then
                ./TAppEncoderStatic -c $CFG_SPIRAL_SCL_RA_1 -i $SEQ -fr 25 -fs $FO -f $4 -wdt $W -hgt $H -q $qp -sr 64 --SAO=0 --InputChromaFormat=444 --ChromaFormatIDC=444 --InputBitDepth=10 --OutputBitDepth=10 --ConformanceMode 1 --ConformanceWindowMode 1 &> out_${2}_${qp}.txt 
        fi
        if [ $3 == 442 ] # HEVC Inter B YUV444_10 (!search window 64!) SCALABLE SPIRAL (!SAO OFF!) RANDOM ACCESS PROFILE 4-WAY (!!!!!!SERIES!!!!!!!)
        then
                ./TAppEncoderStatic -c $CFG_SPIRAL_SCL_RA_2 -i $SEQ -fr 25 -fs $FO -f $4 -wdt $W -hgt $H -q $qp -sr 64 --SAO=0 --InputChromaFormat=444 --ChromaFormatIDC=444 --InputBitDepth=10 --OutputBitDepth=10 --ConformanceMode 1 --ConformanceWindowMode 1 &> out_${2}_${qp}.txt 
        fi
        if [ $3 == 443 ] # HEVC Inter B YUV444_10 (!search window 64!) SCALABLE SPIRAL (!SAO OFF!) RANDOM ACCESS PROFILE 9-WAY (!!!!!!SERIES!!!!!!!)
        then
                ./TAppEncoderStatic -c $CFG_SPIRAL_SCL_RA_3 -i $SEQ -fr 25 -fs $FO -f $4 -wdt $W -hgt $H -q $qp -sr 64 --SAO=0 --InputChromaFormat=444 --ChromaFormatIDC=444 --InputBitDepth=10 --OutputBitDepth=10 --ConformanceMode 1 --ConformanceWindowMode 1 &> out_${2}_${qp}.txt 
        fi
	cd ../../../
	fi
done

